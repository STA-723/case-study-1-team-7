---
title: "Investigating the Effects of DDE and PCB Exposure on Premature Delivery"
author: "Youngsoo Baek, Yunran Chen and Xiaojun Zheng"
fontsize: "11pt"
output:
  pdf_document: 
        latex_engine: xelatex
  html_document:
    keep_md: yes
    fig_caption: TRUE
header-includes:  
  \usepackage{float} 
  \floatplacement{figure}{H}
---

```{r setup, echo=F}
knitr::opts_chunk$set(
	message = FALSE,
	warning = FALSE,
	include = FALSE
)

Longnecker <- readRDS("Longnecker.rds")
```


#### Executive Summary

We study the association between exposure to Dichlorodiphenyldichloroethylene (DDE) and 12 Polychlorinated Biophenyl (PCB) members and the risk of premature delivery. To address the collinearity caused by PCB members, we consider a two-stage modeling process to hybrid Principal Component Analysis (PCA) to binary/ordinal logistic regression. As an alternative, we also consider selecting representative PCBs based on lasso in the first stage. Both models suggest higher exposure to both DDE and PCB is associated with higher odds of preterm delivery.  

#### Introduction
  
Dichlorodiphenyltrichloroethane (DDT) and Polychlorinated biphenyl (PCB) were proved to be toxic, leading to a ban on use in United States in 1972, 1978 respectively. We are interested in whether and how the DDE and PCB relate to risk of premature delivery adjusting other possible confounders such as physical background, demographic background and socio-economic status. Our data comes from a subsample of the US Collaborative Perinatal Project (CPP) conducted by Longecker et al. (2001), which contain concentration doses for DDE and PCBs as well as the gestational ages of 2380 women in 12 medical centers. Other potential predictors are provided such as triglycerides and cholesterol (fat chemicals), smoking status and demographic characteristics such as race, age and socio-economic index. 

#### Materials and Methods

We consider a class of linear regression models that can model the linear association between the probability of preterm delivery and predictors of interest on some suitable scale. In particular, we consider a logistic regression model, where the log-odds of premature delivery are modeled by a linear combination of DDE and PCB levels. While binary logistic regression is a standard method, we suffer loss of information on different delivery periods, which contains information about different levels of risk on the infants' health. Therefore, we bin the gestational ages to reflect increasing levels of risk prescribed by NIH and consider an ordinal logistic regression as follows:
$${\rm Pr}(Y_i\leq k|\mathbf{x}_i) = {\rm logit}^{-1}(\alpha_{k} + \mathbf{x}_i^T\beta)\iff {\rm Odds}(Y_i \leq k|\mathbf{x}_i) = e^{\alpha_k} e^{\mathbf{x}_i^T\beta},$$
where $Y_i$ with four possible values, $k=1,2,3,4$, each corresponding to different categories of preterm delivery with increasing level of infant health risk. The model comes with an assumption that the odds corresponding to each of these levels are proportional. The data exhibit some indication that the model assumption can be violated, which will be discussed in the Discussion Section. (i.e., DDE is observed to have stronger association with premature delivery, as we move from late preterm (nearly around 37-week threshold) to earlier delivery periods.)

The main challenge is high correlation between multiple PCB variables. High correlation between predictors in the regression is known to inflate standard errors of the estimated effects, so our inference on not only the PCBs, but also for other predictors, can be severely limited by adjusting for all of them. Two approaches are discussed. We can either take a weighted sum of PCB variables after standardizing them to the same scale, and adjust for this single variable as a proxy for "aggregated" PCB levels. Alternatively, we can use variable selection methods to exclude PCB variables that are deemed unimportant for the model, and re-fit the regression based on the selected variables only. We consider a two-stage procedure. In the first stage, we either construct a new PCB predictor based on Principal Component Analysis (PCA) or select representative PCBs by Lasso. In the second stage, we include the PCB predictors from the first stage and other potential predictors in the binary/ordinary logistic regression.


#### Results

##### Exploratory Data Analysis

Figure \ref{fig:mis} shows the missing values at each predictor. We exclude the predictor `albumin` for it contains over 90% missing values. In the PCA-logistic model, the ANOVA test of a logistic regression model that includes scores against a model that does not failed to reject the null of no significant effect, which offers justification of not including these in the final model. Thus, we have excluded only 1 subject for whom no PCB levels were measured. In the Lasso-logistic model, we excluded around 22% observations due to the missing values on socio-economic indices and 1 observation with missing value on PCB level. A sensitivity analysis is also conducted to addressing the problem. 

As shown in Figure \ref{fig:cor} , strong correlations exist among PCBs, which suggest a severe multicollinearity may exist among PCBs. Figure \ref{fig:heter_center} shows a heterogeneity across centers exist. Since different centers have distinct demographic background (such as race and income), we assume each center cannot borrow information from others and consider fix effects for 12 centers instead of random effect. For simplicity and to save the degree of freedom, we do not consider the interaction between centers and other predictors.


##### Main Results

For binary logistic regression, we consider a birth that takes place less than 37 weeks as preterm delievery. For ordinal logistic regression, we consider four categories with 32, 36, 37 as thresholds to bin the gestational age into four categories: "very preterm", "moderate", "late preterm" and "normal-late". 

To account for high correlation between PCB members that can inflate variance of the estimated effects, we excluded all PCB levels and included the first principal component from the principal components analysis (PCA). Since this principal component is a weighted sum of all PCB members that are standardized to unit scale, it can be thought of as a proxy variable for "adjusted total" PCB levels. Direct interpretation of the effect magnitude based on regression estimates, however, is not feasible.  

Based on the binary logistic regression model, the significant predictors include DDE, proxy variable for PCB levels, triglyceride and cholesterol levels, along with mean shifts in centers (15,37,82) for which subjects are primarily of black race. Estimated model effects and their 95\% confidence intervals can be found in Table 1. Most of the estimates have a direct scientific interpretation. For instance, for a 1$\mu$g increase in DDE exposure, adjusted for all other variables, a mother has 0.8\% increased odds of premature delivery. Similarly, for a 1g/dL increase in triglyceride level, adjusted for other variables, a mother has 0.3\% increased odds of premature delivery. Such inference, however, is hampered for PCB, as discussed above. We do get an expected positive sign, indicating that PCB has effect oc increasing preterm delivery odds. Ordinal logistic model estimates mostly agree in the signs and magnitudes of the effects; however, cholesterol level is no longer considered a significant variable. 

As an alternative way, we select PCB 74 and PCB 153 as representatives for PCBs based on the minimizing binomial deviance criterion. We include selected PCBs and DDE, along with DDE and adjusting other demorgraphic predictor in binary and ordinal logistic regression, as shown in Table 2. Table 3 present the result from liklihood ratio testing suggesting the potential effects on the risk of preterm delivery of PCB 74 and PCB 153 are significantly non-zero. The result suggests higher exposure to both DDE and PCB is associated with higher odds of preterm delivery, which is consistent with Table 1. 

PCA-logistic model performs slightly better than Lasso-logistic model in terms of BIC and AUC as shown in Table. However, Lasso-logistic model take advantages on interpretating the potential effect of PCBs. For instance, in the logistic model,for a 1 unit increase in PCB 74 exposure, adjusted for all other variables (notice socio-economic status are adjusted in the model), a mother is expected to has 36.8\% increased log odds of premature delivery.

##### Sensitivity Analysis

As introduced above, the models selected by lasso regression involve the score variables about income, education and occupation. With about 20% missingness of score variables, we decided to impute the score variables, and refit the models to see whether there is signiciant change in our result. The method of imputation is called Predictive Mean Matching, which extracts the information from the observations without missing values, and use that to make assumption about the missing entry. Specially, for each missing entry, the method forms a set of complete observations with the predicted values that are close to the predcition of that, and randomly draws the observed value of an obervation to replace the missing value.

After refitting the logistic and ordinal logistic models using the imputed data, we observed that there is almost no change for the estimates of the coefficient for DDE, PCB_074 and PCB_153. At the same time, the confidence intervals for those coefficients narrow a little bit, which match up our intuition. Thus, our models generated based on a lasso selection seems to be robust. 


#### Discussion


\clearpage

#### Tables and Figures

...All tables and figures go here!...

```{r missing, echo=FALSE, message=FALSE, warning=FALSE,cache=TRUE, fig.cap="\\label{fig:mis} Missing Values"}
library(arm)
library(corrplot)
library(naniar)
library(ggplot2)
library(dplyr)
library(tibble)
library(tidyr)
library(purrr)
library(lme4)
library(MASS)
library(ggmosaic)
library(mice)
library(ordinalNet)
data=readRDS("Longnecker.rds")
data=data %>% dplyr::select(gestational_age, dde:cholesterol, center)
gg_miss_upset(data)
```

```{r hist, echo=FALSE, message=FALSE, warning=FALSE,cache=TRUE}
data_46=data#%>%mutate(y=gestational_age)
data_46[data_46$gestational_age>46,"gestational_age"]=46
data_46=data_46%>%select(-albumin)%>%mutate(race=factor(race),center=factor(center))
data_46$earlylvl <- cut(data_46$gestational_age,
                                       breaks = c(0, 31, 33, 36, 46), right = TRUE)
#data_46 %>%
#  dplyr::select(gestational_age:triglycerides,-triglycerides,-dde) %>%
#  gather() %>% 
#  ggplot(aes(value)) +
#    facet_wrap(~ key, scales = "free") +
#    geom_histogram() + theme_bw()
```

```{r corrplot, echo=FALSE,cache=TRUE, fig.width = 3.4,fig.cap="\\label{fig:cor} Correlation plot across PCBs"}
data_ = data %>% mutate(race=as.numeric(race))
M2 = cor(as.matrix(na.omit(data_%>%select(pcb_028:pcb_203))))
corrplot.mixed(M2,number.cex=0.7, upper="ellipse",tl.cex=0.5)
#M3 = cor(as.matrix(na.omit(data_)))
#M3[1,-1]
#cordf=data.frame(cor=M3[1,-1],var=names(M3[1,-1]))
#ggplot(cordf,aes(x=var,y=cor))+geom_point()+theme_bw()
```

```{r heter, echo=FALSE, cache=TRUE,fig.cap="\\label{fig:heter_center} Heterogeneity across Centers"}
ggplot(data,mapping = aes(x=as.factor(center),y=gestational_age))+geom_boxplot()+theme_bw()+xlab("center")
```


\clearpage

##### Appendix

##### References
...If there are any...
